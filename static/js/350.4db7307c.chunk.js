"use strict";(self.webpackChunksmartq_react=self.webpackChunksmartq_react||[]).push([[350],{10:(e,t,s)=>{s.d(t,{A:()=>i});s(43);var a=s(614),n=s(579);const i=e=>{let t,{queueId:s,width:i=150,height:r=150}=e;t="/smartq-react",t=t.replace(/\/+$/,"");const o=`${t}/#/join-queue?queueId=${s}`;return(0,n.jsx)(a.X,{value:o,size:i})}},82:(e,t,s)=>{s.a(e,(async(e,a)=>{try{s.d(t,{db:()=>h,j2:()=>l});var n=s(11),i=s(726),r=s(717),o=s(214),c=e([n,i,r,o]);[n,i,r,o]=c.then?(await c)():c;const d={apiKey:"AIzaSyAhBlyXYwfLE1rXPcWRiouJfsp6gIpG894",authDomain:"smartq-d015b.firebaseapp.com",projectId:"smartq-d015b",storageBucket:"smartq-d015b.firebasestorage.app",messagingSenderId:"452644823738",appId:"1:452644823738:web:7a133f086ff93200b39883"},u=(0,n.initializeApp)(d),l=(0,i.getAuth)(u),h=(0,r.getFirestore)(u),m=(0,o.getMessaging)(u);(0,o.onMessage)(m,(e=>{console.log("Message received:",e),alert(`Notification: ${e.notification.title} - ${e.notification.body}`)})),a()}catch(d){a(d)}}))},350:(e,t,s)=>{s.a(e,(async(e,a)=>{try{s.r(t),s.d(t,{default:()=>h});var n=s(43),i=s(662),r=s(82),o=s(717),c=s(726),d=s(10),u=s(579),l=e([r,o,c]);[r,o,c]=l.then?(await l)():l;const h=()=>{const[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(""),[l,h]=(0,n.useState)(!0),[m,p]=(0,n.useState)({}),b=(0,i.Zp)(),g=(0,o.collection)(r.db,"queues");(0,n.useEffect)((()=>(0,c.onAuthStateChanged)(r.j2,(e=>{if(e){const s=(0,o.query)(g,(0,o.where)("adminId","==",e.uid)),a=(0,o.onSnapshot)(s,(e=>{const s=e.docs.map((e=>({id:e.id,...e.data()})));t(s),h(!1)}));return()=>a()}b("/auth")}))),[b,g]);return(0,u.jsxs)("div",{className:"container",children:[(0,u.jsx)("h1",{children:"Queue Management"}),(0,u.jsx)("button",{className:"btn",onClick:()=>b("/admin/dashboard"),children:"Back to Dashboard"}),(0,u.jsxs)("section",{style:{marginBottom:"2rem"},children:[(0,u.jsx)("h2",{children:"Create a New Queue"}),(0,u.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),s.trim())try{const e=r.j2.currentUser,t={name:s,adminId:e.uid,status:"active",users:[],currentPosition:1,estimatedWaitTime:0,createdAt:new Date};await(0,o.addDoc)(g,t),a("")}catch(t){console.error("Error creating queue:",t)}},children:[(0,u.jsx)("input",{type:"text",placeholder:"Enter Queue Name",value:s,onChange:e=>a(e.target.value),required:!0,style:{width:"100%",marginBottom:"0.5rem",padding:"0.5rem"}}),(0,u.jsx)("button",{type:"submit",className:"btn",children:"Create Queue"})]})]}),(0,u.jsxs)("section",{children:[(0,u.jsx)("h2",{children:"Active Queues"}),l?(0,u.jsx)("p",{children:"Loading queues..."}):0===e.length?(0,u.jsx)("p",{children:"No queues found. Create one above."}):e.map((e=>{const t=e.users?e.users.find((e=>0===e.position)):null,s=t?`You are serving now: ${t.name}, ${t.email}`:"You are serving now: No one";return(0,u.jsxs)("div",{className:"queue-card",style:{marginBottom:"2rem",padding:"1rem",border:"1px solid #ddd",borderRadius:"8px"},children:[(0,u.jsx)("h3",{children:e.name}),(0,u.jsxs)("p",{children:["Status: ",(0,u.jsx)("span",{children:e.status})]}),(0,u.jsxs)("p",{children:["Users: ",e.users?e.users.filter((e=>e.position>0)).length:0]}),(0,u.jsx)("p",{children:s}),(0,u.jsx)("div",{style:{marginBottom:"1rem"},children:(0,u.jsx)(d.A,{queueId:e.id})}),(0,u.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[(0,u.jsx)("button",{className:"btn",onClick:()=>(async(e,t)=>{p((t=>({...t,[e]:!0})));try{const s=(0,o.doc)(r.db,"queues",e);await(0,o.updateDoc)(s,{status:"active"===t?"paused":"active"})}catch(s){console.error(s)}p((t=>({...t,[e]:!1})))})(e.id,e.status),disabled:m[e.id],children:"active"===e.status?"Pause":"Resume"}),(0,u.jsx)("button",{className:"btn",onClick:()=>(async e=>{p((t=>({...t,[e]:!0})));try{const t=(0,o.doc)(r.db,"queues",e),s=await(0,o.getDoc)(t);if(!s.exists())return;let a=s.data().users||[];a=a.filter((e=>0!==e.position)),a.sort(((e,t)=>e.position-t.position)),a=a.map(((e,t)=>({...e,position:t}))),await(0,o.updateDoc)(t,{users:a})}catch(t){console.error(t)}p((t=>({...t,[e]:!1})))})(e.id),disabled:m[e.id],children:"Next"}),(0,u.jsx)("button",{className:"btn delete-btn",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this queue? This action cannot be undone.")){p((t=>({...t,[e]:!0})));try{await(0,o.deleteDoc)((0,o.doc)(r.db,"queues",e))}catch(t){console.error(t)}p((t=>({...t,[e]:!1})))}})(e.id),disabled:m[e.id],children:"Delete"})]})]},e.id)}))]})]})};a()}catch(h){a(h)}}))}}]);
//# sourceMappingURL=350.4db7307c.chunk.js.map